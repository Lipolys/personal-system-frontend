<h2 mat-dialog-title>Registrar Anamnese</h2>
<mat-dialog-content>
  <div class="form-header">
    <strong>Anamnese:</strong> {{ patient?.name }}
  </div>

  <mat-stepper #stepper>
    <!-- Etapa 1: Queixa e Histórico -->
    <mat-step [stepControl]="firstFormGroup" errorMessage="Preencha as informações obrigatórias.">
      <section class="form-container">
        <form [formGroup]="firstFormGroup" class="form-group">
          <ng-template matStepLabel>Queixa Principal e Histórico</ng-template>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>Data da Anamnese</mat-label>
              <input matInput formControlName="anamnesisDate" [matDatepicker]="picker">
              <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Queixa Principal</mat-label>
              <textarea matInput formControlName="mainComplaints" rows="3" required></textarea>
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>Histórico Médico</mat-label>
              <textarea matInput formControlName="medicalHistory" rows="3"></textarea>
            </mat-form-field>
          </div>

          <div class="form-buttons">
            <button mat-button matDialogClose>Cancelar</button>
            <button mat-button matStepperNext>Próximo</button>
          </div>
        </form>
      </section>
    </mat-step>

    <!-- Etapa 2: Dados Corporais -->
    <mat-step [stepControl]="secondFormGroup" errorMessage="Preencha os campos obrigatórios.">
      <section class="form-container">
        <form [formGroup]="secondFormGroup" class="form-group">
          <ng-template matStepLabel>Dados Corporais</ng-template>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>Peso (kg)</mat-label>
              <input matInput type="number" formControlName="weight" required>
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Altura (cm)</mat-label>
              <input matInput type="number" formControlName="height" required>
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Observações</mat-label>
              <textarea matInput formControlName="observations" rows="2"></textarea>
            </mat-form-field>
          </div>

          <div class="form-buttons">
            <button mat-button matStepperPrevious>Voltar</button>
            <button mat-button matStepperNext>Próximo</button>
          </div>
        </form>
      </section>
    </mat-step>

    <!-- Etapa 3: Circunferência e Medidas -->
    <mat-step [stepControl]="thirdFormGroup" errorMessage="Preencha os campos obrigatórios.">
      <section class="form-container">
        <form [formGroup]="thirdFormGroup" class="form-group">
          <ng-template matStepLabel>Medidas e Composição Corporal</ng-template>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>Circunferência da Cintura (cm)</mat-label>
              <input matInput type="number" formControlName="waistCircumference">
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Circunferência do Quadril (cm)</mat-label>
              <input matInput type="number" formControlName="hipCircumference">
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>% de Gordura Corporal</mat-label>
              <input matInput type="number" formControlName="bodyFatPercentage">
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Massa Muscular (kg)</mat-label>
              <input matInput type="number" formControlName="muscleMass">
            </mat-form-field>
          </div>

          <div class="form-row">
            <mat-form-field appearance="fill">
              <mat-label>IMC</mat-label>
              <input matInput type="number" formControlName="bodyMassIndex">
            </mat-form-field>

            <mat-form-field appearance="fill">
              <mat-label>Relação Cintura/Quadril</mat-label>
              <input matInput type="number" formControlName="waistHipRatio">
            </mat-form-field>
          </div>

          <div class="form-buttons">
            <button mat-button matStepperPrevious>Voltar</button>
            <button mat-button (click)="salvarAnamnese()">Finalizar</button>
          </div>
        </form>
      </section>
    </mat-step>
  </mat-stepper>
</mat-dialog-content>
